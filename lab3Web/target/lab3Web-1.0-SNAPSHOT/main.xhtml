<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:composite="http://java.sun.com/jsf/composite"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
<h:head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
    <h:outputStylesheet library="css" name="file.css" />
    <title>Лабораторная работа по Веб-программированию</title>
</h:head>
<h:body>
   <div class="frame2">
    <svg xmlns="http://www.w3.org/2000/svg" width="500" height="400" class="svg-graph" id="svg">

        <line class="axis" x1="0" x2="300" y1="150" y2="150" stroke="black"></line>
        <line class="axis" x1="150" x2="150" y1="0" y2="300" stroke="black"></line>

        <polygon points="150,0 144,15 156,15" stroke="black"></polygon>
        <polygon points="300,150 285,156 285,144" stroke="black"></polygon>

        <line class="coor-line" x1="200" x2="200" y1="155" y2="145" stroke="black"></line>
        <line class="coor-line" x1="250" x2="250" y1="155" y2="145" stroke="black"></line>

        <line class="coor-line" x1="50"  x2="50"  y1="155" y2="145" stroke="black"></line>
        <line class="coor-line" x1="100" x2="100" y1="155" y2="145" stroke="black"></line>

        <line class="coor-line" x1="145" x2="155" y1="100" y2="100" stroke="black"></line>
        <line class="coor-line" x1="145" x2="155" y1="50"  y2="50"  stroke="black"></line>

        <line class="coor-line" x1="145" x2="155" y1="200" y2="200" stroke="black"></line>
        <line class="coor-line" x1="145" x2="155" y1="250" y2="250" stroke="black"></line>

        <text class="coor-text" x="195" y="140">R/2</text>
        <text class="coor-text" x="248" y="140">R</text>

        <text class="coor-text" x="40" y="140">-R</text>
        <text class="coor-text" x="90" y="140">-R/2</text>

        <text class="coor-text" x="160" y="105">R/2</text>
        <text class="coor-text" x="160" y="55">R</text>

        <text class="coor-text" x="160" y="205">-R/2</text>
        <text class="coor-text" x="160" y="255">-R</text>

        <text class="axis-text" x="290" y="170">x</text>
        <text class="axis-text" x="160" y="13">y</text>

        <!-- first figure-->
        <rect x="50" y="150" width="100" height="100" style="fill:#cdc684; stroke:#cdc684; fill-opacity:0.3;" />

        <!-- second figure-->
        <polygon points="150,150 150,200, 200,150" style="fill:#cdc684; stroke:#cdc684; fill-opacity:0.3;"></polygon>

        <!-- third figure-->
        <path d="M 150 50 A 100 100, 0, 0, 1, 250 150 L 150 150 Z" style="fill:#cdc684; stroke:#cdc684; fill-opacity:0.3;"></path>
        <circle r="0" cx="150" cy="150" id="target-dot"></circle>
    </svg>
   </div>
    <div class="container2">
        <h:form id="choose-form">
        <div class="p1" id="selectX">
            <h:outputLabel value="Выберите X:" type="hidden" id="X" required="true"/>
            <h:commandLink shape="circle"  value="-3" onclick="setX(this)" >
                    <f:ajax listener="#{selectXBean.setValue(-3)}"/>
            </h:commandLink>
            <h:commandLink shape="circle" value="-2" onclick="setX(this)">
                <f:ajax listener="#{selectXBean.setValue(-2)}"/>
            </h:commandLink>
            <h:commandLink shape="circle"  value="-1" onclick="setX(this)" >
                <f:ajax listener="#{selectXBean.setValue(-1)}"/>
            </h:commandLink>
            <h:commandLink shape="circle"  value="0" onclick="setX(this)" >
                <f:ajax listener="#{selectXBean.setValue(0)}"/>
            </h:commandLink>
            <h:commandLink shape="circle"  value="1" onclick="setX(this)" >
                <f:ajax listener="#{selectXBean.setValue(1)}"/>
            </h:commandLink>
            <h:commandLink shape="circle"  value="2" onclick="setX(this)" >
                <f:ajax listener="#{selectXBean.setValue(2)}"/>
            </h:commandLink>
            <h:commandLink shape="circle"  value="3" onclick="setX(this)" >
                <f:ajax listener="#{selectXBean.setValue(3)}"/>
            </h:commandLink>
            <h:commandLink shape="circle"  value="4" onclick="setX(this)" >
                <f:ajax listener="#{selectXBean.setValue(4)}"/>
            </h:commandLink>
            <h:commandLink shape="circle"  value="5" onclick="setX(this)">
                <f:ajax listener="#{selectXBean.setValue(5)}"/>
            </h:commandLink>

        </div>
            <div class="p2" id="text">
                <h:outputLabel value="Выберите Y:"/>
                <h:inputText id="y-select" class="pY" value="#{selectYBean.value}" size="27" validator="#{selectYBean.validateY}"
                             a:placeholder="Значение от -3 до 5" required="true">
                    <f:validateDoubleRange minimum="-3" maximum="5" />

                <f:ajax execute="y-select" render="@form"/>
                </h:inputText>
                <h:message for="text" style="border: 3px solid red"/>
            </div>
        <div class="p3" id="selectR">
            <h:selectOneMenu id="r-select" value="#{selectRBean.value}"
                             validator="#{selectRBean.validateSelectR}">
                <h:outputLabel value="Выберите R: "/>
                <f:selectItem itemLabel="R" itemDisabled="true"/>
                <f:selectItem itemValue = "1" itemLabel = "1" />
                <f:selectItem itemValue = "1.5" itemLabel = "1.5" />
                <f:selectItem itemValue = "2" itemLabel = "2" />
                <f:selectItem itemValue = "2.5" itemLabel = "2.5" />
                <f:selectItem itemValue = "3" itemLabel = "3" />
                <f:validateRequired />
                <f:ajax execute="@this" render="@form" />
            </h:selectOneMenu>
        </div>
            <div id="btn1">
              <h:commandButton id="submit" type="submit" class="submit" value="Check">
                  <f:ajax execute="@form" listener="#{checkAreaBeanResult.addNewResult(selectXBean.value,
                                        selectYBean.value, selectRBean.value, 'SUBMIT')}" render="@form resultTable" />
              </h:commandButton>
            </div>
        </h:form>
    </div>
    <span class="errorText" id="errorText"></span>
    <div class="container3">
        <h:dataTable id="resultTable" value="#{checkAreaBeanResult.results}" var="result">
            <h:column>
                <f:facet name = "header">x</f:facet>
                <h:outputText value="#{result.x}">
                </h:outputText>

            </h:column>
            <h:column>
                <f:facet name = "header">y</f:facet>
                <h:outputText value=" #{result.y}">
                </h:outputText>
            </h:column>
            <h:column>
                <f:facet name = "header">r</f:facet>
                #{result.r}
            </h:column>
            <h:column>
                <f:facet name = "header">Итог</f:facet>
                #{result.resultArea ? "Hit" : "Miss"}
            </h:column>
            <h:column>
                <f:facet name = "header">Текущее время</f:facet>
                <h:outputText converter="localDateTimeConverter" value="#{result.time}" />
            </h:column>
            <h:column>
                <f:facet name = "header">Время скрипта</f:facet>
                 #{result.timeScript}
            </h:column>
        </h:dataTable>
    </div>
    <div class="return">
        <h:form>
            <h:commandButton id="return" value="Вернуться" action="goToPageBack"/>
        </h:form>
    </div>
    <h:form id="graphSelect">
        <h:inputHidden id="graph-x" value="#{selectGraphBean.x}" />
        <h:inputHidden id="graph-y" value="#{selectGraphBean.y}" />
        <p:remoteCommand name="updateBeanValues" update="graph-x graph-y resultTable choose-form"
                         action="#{checkAreaBeanResult.addNewResult(selectGraphBean.x, selectGraphBean.y, selectRBean.value, 'CLICK')}"/>
    </h:form>
    <h:outputScript library="js" name="drawPoint.js"></h:outputScript>
    <h:outputScript>
        <ui:repeat var="loadedResults" value="#{checkAreaBeanResult.results}">
            drawPoint('#{loadedResults.x}', '#{loadedResults.y}', '#{loadedResults.r}', '#{loadedResults.resultArea}');
        </ui:repeat>
    </h:outputScript>
</h:body>
</html>
